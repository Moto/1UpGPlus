<!DOCTYPE html>
<html><head></head>
<body>

<script type="text/javascript" src="options.js"></script>

<script>
g_reblips = [];

chrome.extension.onRequest.addListener(

	function(request, sender, sendResponse)
	{
		response = {};

		msg = request.m;

		if ( msg == 'enable' ) {
			chrome.pageAction.show(sender.tab.id);
			console.log("enabled icon");
		}

		else if ( msg == 'disable' ) {
			chrome.pageAction.hide(sender.tab.id);
			console.log("disabled icon");
		}

		else {
			console.log("Unknown message: ", msg);
			response = undefined;
		}
		
		console.log('Sending response:', response);
		sendResponse(response);
	}
);

chrome.tabs.onUpdated.addListener(

	function(tabId, info, tab){
		if ( ! get_reblip_in_new_window() )
			return;

		if ( tab.url.indexOf("http://blip.fm") == 0 ) {
			chrome.pageAction.show(tabId);
		}
	}
);

</script></body></html>
